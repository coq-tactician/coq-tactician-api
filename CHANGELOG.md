# stdlib-lgraph-intermediate-v5-global
http://64.71.146.254:8000/SFyud_C5TmEq7AwnK9jaLsfTFMzgBl54cQ0pl2FJB-x9o2Hk24F4jO_W75RqGdOJ/graph/lgraph/stdlib-lgraph-intermediate-v5-global.tar.xz

Changes w.r.t. `v5-local` are:
- Tactical argument now also include global references. Global references are given priority over local references.
- The capnp magic number has *not* been upgraded in this version, because v5-local and v5-global share the same API.

# stdlib-lgraph-intermediate-v5-local
http://64.71.146.254:8000/SFyud_C5TmEq7AwnK9jaLsfTFMzgBl54cQ0pl2FJB-x9o2Hk24F4jO_W75RqGdOJ/graph/lgraph/stdlib-lgraph-intermediate-v4-local.tar.xz

Changes in this dataset w.r.t. `v3` are:
- It can be generated by everyone
- The tactical decomposition is slightly more conservative in `v5` than in `v3`. This is so little that it is probably undetectable though.
- As a result of the modified decomposition, the basic statistics of the dataset have also been changed to a small degree: 
```
Nodes total 60220300
Edges total 108697004
Tactics total 985
Tactics entropy (bits) 5.512928911238009
Tactics base text total 912
Tactics base intermtext total 9202
Tactical definitions total 11348
Proof steps total 197090
```
- Dependency references now point to the actual `.bin` files in the dataset, instead of the bogus corresponding `.v` files (this was a bug)
- Starting with version v4 we will version the capnp protocol through the magic id at the top of the `.capnp` file. Every new incompatible version will get a new hash
- Tactical arguments are now wrapped in a variant type. Arguments that cannot be resolved are encoded using the `unresolvable` variant (a `None`-type)

# stdlib-lgraph-intermediate-v4-local
Buggy, do not use

# stdlib-lgraph-intermediate-v3
http://64.71.146.254:8000/SFyud_C5TmEq7AwnK9jaLsfTFMzgBl54cQ0pl2FJB-x9o2Hk24F4jO_W75RqGdOJ/graph/lgraph/stdlib-lgraph-intermediate-v3.tar.xz

Changes w.r.t the previous version:
- Reversed the order of the context in the textual representation of proof states to be consistent with Coq (bug found by Jason)
- Nodes in the graph that represent an element from the local context now have their textual name attached (requested by Jason)
- This dataset features a much more aggressive tactical decomposition than the previous one
  + The number of unique base tactics has been reduced from (approximately) 2700 to 987
  + As a consequence, the number of recorded proof states has increased from 150k (approximately) to 197k
  + Note that the number of unique textual representations of tactics is 914, a bit lower than 987 because the textual representation is not always precise
  + The tactical decomposition is still a work in progress, but we are now reaching diminishing returns. One might think that 987 tactics is a lot, but two-third of those occur less than 10 times in the dataset. There are still many tactics that can be decomposed (I estimate about 300), but I don't think it is currently worth spending time on.
  + One goal of the decomposition is to not have any tactics that generate arbitrary names. For example, we convert a tactic like intro `my_fancy_variable_name` to `intros ?` in order to let Coq invent the name for us. This is also still a work in progress, but we are also reaching diminishing returns here. There are currently about 5000 instances of generative variables that have not been properly anonymized yet.
- The dataset now encodes arguments of tactics as follows:
  + The number of parameters of each base tactic is fixed (if not, it is a bug, please report).
  + For each argument of a tactic, we look up the first free variable referencing the local context inside of that argument. Then we replace the whole argument with that variable.
  + If an argument does not reference anything from the local context, the argument is replaced with a pointer to node 0 (yes I know that a `None`` type would be better but I'm to lazy for that). Note that arguments that represent generative names also point to node 0. As explained above, this happens about 5000 times.
- There are now three textual representations of tactics:
  + `text`: The full text representation of the tactic, including the full original arguments
  + `baseText`: A textual representation of the base tactic without any arguments
  + `intermText`: A textual representation of the tactic where parameters are restricted to the local context, directly mirroring the encoding of the parameters form the previous bullet-point

# stdlib-lgraph-intermediate-v2
http://64.71.146.254:8000/SFyud_C5TmEq7AwnK9jaLsfTFMzgBl54cQ0pl2FJB-x9o2Hk24F4jO_W75RqGdOJ/graph/lgraph/stdlib-lgraph-intermediate-v2.tar.xz

Changes:
- Proofs are now grouped by lemma
- Definitions are grouped, have a hash, and have a name (string)
- Tactics now have an id, and arguments that include things from the local context and the global context. We cannot always resolve all arguments yet (in particular arguments given to intros), in which case their node-id is zero. We do not yet have full graphs of term arguments. Term arguments are currently thrown away, keeping only the constants inside those arguments. In order to keep the amount of arguments under control, we only add opaque definitions to the arguments (opaque definitions correspond loosely to lemmas).
- Tactics now come with a string representation. Note that this is not a 1-to-1 mapping to the tactic representation above, because in the string representation full term arguments are present.
- Proof states now also come with a string representation.
- The amount of proof states has been reduced from 250k to 150k. The reason for this is fairly technical, I'll explain during the meeting.
- Tactics now have attributes text and baseText. The first corresponds to the fully printed text of the tactical. The second one corresponds roughly to the text of the base tactic without arguments. The correspondence is rough, because Coq's printing facility does not reflect 100% of the internal tactical AST. So while there are about 2700 unique tactic bases, there are only 2600 unique corresponding strings.

# stdlib-lgraph-intermediate-v1
Buggy, do not use.
